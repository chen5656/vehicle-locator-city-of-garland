	set echo	off;

--	===================================================================================
--	when location has many asset numbers, what are their sizes
--	===================================================================================

--	select count(count(*))

	select location_no, service_seq, 
		 ums_attrib_value ( 'SW', 'FL', asset_no, 'SIZE') 	size
	from	sfg.um00155t@umsp.world

	where	(location_no, service_seq)	in
(
	select location_no, service_seq 
--		,min(asset_no), max(asset_no)

	from	sfg.um00155t@umsp.world

	where	ams_asset_area	= 'SW'
	and	ams_asset_tp	= 'FL'

	and	location_no < 200

	group by	location_no, service_seq
	having	count(*) > 1
)

	order by location_no, service_seq, asset_no;

	set echo	on;


=============================================================================================================
    
	open	am00510m_cursor(asset_area, asset_type, asset_no, format_cd, t_count, data_type, p_pointer);

	select * from sfg.am00510m@umsp.world
	where rownum < 11;


AS F FMT_C AS ASSET_NO        TRX_CNT    SFG_KEY_1                 SFG_KEY_2                 SFG_KEY_3                 SFG_KEY_4                 SFG_KEY_5                 U IVALUE1    IVALUE2    IVALUE3    IVALUE4    IVALUE5    IVALUE6    IVALUE7    IVALUE8    IVALUE9    IVALUE10   IVALUE11   IVALUE12   IVALUE13   IVALUE14   IVALUE15   IVALUE16   IVALUE17   IVALUE18   IVALUE19   IVALUE20   NVALUE1    NVALUE2    NVALUE3    NVALUE4    NVALUE5    NVALUE6    NVALUE7    NVALUE8    NVALUE9    NVALUE10   NVALUE11   NVALUE12   NVALUE13   NVALUE14   NVALUE15   NVALUE16   NVALUE17   NVALUE18   NVALUE19   NVALUE20   DVALUE1   DVALUE2   DVALUE3   DVALUE4   DVALUE5   DVALUE6   DVALUE7   DVALUE8   DVALUE9   DVALUE10  DVALUE11  DVALUE12  DVALUE13  DVALUE14  DVALUE15  DVALUE16  DVALUE17  DVALUE18  DVALUE19  DVALUE20  VVALUE1                                                                          VVALUE2                                                                          VVALUE3                                                                          VVALUE4                                                                          VVALUE5                                                                          VVALUE6                                                                          VVALUE7                                                                          VVALUE8                                                                          VVALUE9                                                                          VVALUE10                                                                         VVALUE11                                                                         VVALUE12                                                                         VVALUE13                                                                         VVALUE14                                                                         VVALUE15                                                                         VVALUE16                                                                         VVALUE17                                                                         VVALUE18                                                                         VVALUE19                                                                         VVALUE20                                                                         CVALUE1                                                                          CVALUE2                                                                          CVALUE3                                                                          CVALUE4                                                                          CVALUE5                                                                          CVALUE6                                                                          CVALUE7                                                                          CVALUE8                                                                          CVALUE9                                                                          CVALUE10                                                                         CVALUE11                                                                         CVALUE12                                                                         CVALUE13                                                                         CVALUE14                                                                         CVALUE15                                                                         CVALUE16                                                                         CVALUE17                                                                         CVALUE18                                                                         CVALUE19                                                                         CVALUE20                                                                         SEC_CD     ADD_BY   ADD_DTM   CHG_BY   CHG_DTM   S
-- - ----- -- --------------- ---------- ------------------------- ------------------------- ------------------------- ------------------------- ------------------------- - ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- --------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------- -------- --------- -------- --------- -
SW T FL    FL 1                        0 key1                      key2                      key3                      key4                      key5                      #                                                                                                                                                                                                                                      1                                                                                                                                                                                                                                                                                                                                                                                                                          8CMP2                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 DGOMEZ   03-JUL-02 F
SW T FL    FL 2                        0 key1                      key2                      key3                      key4                      key5                      $                                                                                                                                                                                                                                      2                                                                                                                                                                                                                                                                                                                                                                                                                          8CSP4                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 DGOMEZ   12-JUL-02 F
SW T FL    FL 3                        0 key1                      key2                      key3                      key4                      key5                      !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 CONV     27-SEP-00 F
SW T FL    FL 4                        0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                   6282                                                                                                                                                                                                                                                                                                                                                                                                                          6CSP2                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 BHAZA    29-SEP-00 F
SW T FL    FL 5                        0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                  60065                                                                                                                                                                                                                                                                                                                                                                                                                          6CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 BHAZA    29-SEP-00 F
SW T FL    FL 6                        0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                   6206                                                                                                                                                                                                                                                                                                                                                                                                                          6CSP2                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 BHAZA    29-SEP-00 F
SW T FL    FL 7                        0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                   4212                                                                                                                                                                                                                                                                                                                                                                                                                          4CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 BHAZA    29-SEP-00 F
SW T FL    FL 8                        0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                  20025                                                                                                                                                                                                                                                                                                                                                                                                                          2CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 DGOMEZ   17-JAN-01 F
SW T FL    FL 9                        0 key1                      key2                      key3                      key4                      key5                      #                                                                                                                                                                                                                                      9                                                                                                                                                                                                                                                                                                                                                                                                                          2CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 DGOMEZ   28-MAR-02 F
SW T FL    FL 10                       0 key1                      key2                      key3                      key4                      key5                      "                                                                                                                                                                                                                                  80017                                                                                                                                                                                                                                                                                                                                                                                                                          8CSP1                                                                            CITY OWNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0 CONV     27-SEP-00 BHAZA    29-SEP-00 F


=============================================================================================================

=================================================================================================

	select count(distinct asset_no)						-- 	1842
	from sfg.am00510m@umsp.world;

	select count(*) from sfg.um00155t@umsp.world;				--	3736
	select count(distinct asset_no) from sfg.um00155t@umsp.world;	--	1780



	select count(distinct location_no)		--	83508
	from sfg.um00100m@umsp.world;

	select count(distinct asset_no)		--	61862
	from sfg.um00100m@umsp.world;



=================================================================================================


	select distinct table_name, column_name, data_type, column_id
	from	 all_tab_columns@umsp.world
	where	 owner = 'SFG'
--	and	table_name = 'AM00200M'
--	and	table_name  like '%%';
	and	column_name like '%ASSET_NO%';




	select 
		rpad(table_name, 12)	table_name ,
		rpad(column_name,20)	column_name,
		rpad(data_type,  10)	type,
		lpad(data_length,3)	length,
		lpad(column_id,  3)	seq

	from	 all_tab_columns@umsp.world
	where	 owner = 'SFG'
	and	 table_name		in
(										
	select table_name						--	what columns should table possess
	from	 all_tab_columns@umsp.world
	where	 owner = 'SFG'
	and	 column_name = 'ASSET_NO'	--	UM00155T, AM00111T, UM00100M, 130T, 150T, 151T

	intersect

	select table_name
	from	 all_tab_columns@umsp.world
	where	 owner = 'SFG'
	and	 column_name = 'LOCATION_NO'
)
	order by 1,2,3,4,5;


